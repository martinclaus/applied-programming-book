

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Datenein- und Ausgabe &#8212; Applied Programming for Physics of the Earth System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0-alpha.0/dist/embed.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="canonical" href="https://martinclaus.github.io/applied-programming-book/content/8_IO.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />


    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<!-- Put requirejs at the end so it's always after bootstrap -->
<!-- TODO: remove this once https://github.com/pandas-dev/pydata-sphinx-theme/pull/149 is merged -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>


<!-- Opengraph tags -->
<meta property="og:url"         content="https://martinclaus.github.io/applied-programming-book/content/8_IO.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Datenein- und Ausgabe" />
<meta property="og:description" content="Datenein- und Ausgabe  Die Hauptanwendung von Python (oder jeder anderen Programmiersprache) in eurer späteren Arbeit wir die Verarbeitung und Analyse von Daten" />
<meta property="og:image"       content="https://martinclaus.github.io/applied-programming-book/_static/logo.png" />

<meta name="twitter:card" content="summary">


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Applied Programming for Physics of the Earth System</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="work_environments.html">Interactive Work Environment</a>
  </li>
  <li class="">
    <a href="programming_languages.html">What is a Programming Language</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Basics</p>
</li>
  <li class="">
    <a href="basics/basics.html">Basics</a>
  </li>
  <li class="">
    <a href="basics/primitive_data_types.html">Primitive Data Types</a>
  </li>
  <li class="">
    <a href="basics/sequences.html">Sequences</a>
  </li>
  <li class="">
    <a href="basics/program_flow_and_structure.html">Program Flow and Structure</a>
  </li>
  <li class="">
    <a href="basics/functions.html">Functions</a>
  </li>
</ul>
</nav>
<p class="navbar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/content/8_IO.ipynb.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/martinclaus/applied-programming-book/master?urlpath=lab/tree/content/8_IO.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="../_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                <a class="jupyterhub-button" href="https://weblab.uni-kiel.de/hub/user-redirect/git-pull?repo=https://github.com/martinclaus/applied-programming-book&urlpath=lab/tree/applied-programming-book/content/8_IO.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip" data-placement="left"><img class="jupyterhub-button-logo" src="../_static/images/logo_jupyterhub.svg" alt="Interact on JupyterHub">JupyterHub</button></a>
                
                
            </div>
        </div>
        

        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#datenformat" class="nav-link">Datenformat</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#csv" class="nav-link">CSV</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#netcdf" class="nav-link">NETCDF</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#struktur-eine-netcdf-datensatzes" class="nav-link">Struktur eine NetCDF Datensatzes</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#lesen-von-daten" class="nav-link">Lesen von Daten</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#schreiben-von-netcdf-datensatzen" class="nav-link">Schreiben von netCDF Datensätzen</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#andere-datenformate" class="nav-link">Andere Datenformate</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 col-xxl-7 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="datenein-und-ausgabe">
<h1>Datenein- und Ausgabe<a class="headerlink" href="#datenein-und-ausgabe" title="Permalink to this headline">¶</a></h1>
<p>Die Hauptanwendung von Python (oder jeder anderen Programmiersprache) in eurer späteren Arbeit wir die Verarbeitung und Analyse von Daten sein.</p>
<center>
<img src='slides/img/8_data_life_cycle.png' width='50%' />
</center><p>Dazu werdet ihr sowohl selbst erhobene Daten (Simulationen, Messungen) als auch bereits bestehende Daten verwenden. Das Teilen und verfügbar machen Daten ist ein zentraler Bestandteil der wissenschaftlichen Praxis. Deshalb solltet Ihr schon beim Prozessieren der eigenen Daten daran denken, diese vollständig mit <a class="reference external" href="https://de.wikipedia.org/wiki/Metadaten">Metadaten</a> zu beschreiben.</p>
<p><strong>Schlechtes Beispiel:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  0|    1|    2|    3|    4|    5|    6|    7|    8|    9|
----------------------------------------------------------
1.2| 2.34|  4.6| 2.31|567.1|45.24| 4.63|1.855|  4.2|  1.5|
</pre></div>
</div>
<p><strong>Gutes Beispiel:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Incubator experiment No. 3456
Date: 13.03.2018
Contact: Martin Claus &lt;mclaus@geomar.de&gt;
Bacteria: Escherichia coli
Substrate: Agar plates
Cultivation: 10 days following Aaronson et al. (2017)

temperature [°C]   |   0|    1|    2|    3|    4|    5|    6|    7|    8|    9|
-----------------------------------------------------------------------------
growth rate [1/day]| 1.2| 2.34|  4.6| 2.31|567.1|45.24| 4.63|1.855|  4.2|  1.5|
</pre></div>
</div>
<hr class="docutils" />
<div class="section" id="datenformat">
<h2>Datenformat<a class="headerlink" href="#datenformat" title="Permalink to this headline">¶</a></h2>
<p>Das Datenformat bezeichnet die Art, wie die Daten strukturiert sind und wie sie bei ihrer Verarbeitung zu interpretieren sind. Generell kann man klassifizieren nach:</p>
<ul class="simple">
<li><p>Selbstbeschreibende Datenformate: Metadaten enthalten</p></li>
<li><p>nicht-selbstbeschreibende Datenformate: Metadaten sind getrennt von Daten</p></li>
</ul>
<p>Weiter kann man klassifizieren nach der Art, wie die Datenkodiert sind</p>
<ul class="simple">
<li><p>Binäre Datenformate:
Daten werden in binärform gespeichert (wie sie im Speicher sind). Das Datenformat (i.e. Anzahl Bits, Datentyp, etc.)
muss bekannt sein und sollte in den Metadaten enthalten sein</p></li>
<li><p>Textbasierte Datenformate:
Die Informationen sind als Textzeichen codiert (ASCII, UTF-8 oder ähnliches). Die Codierung und die Struktur der
Daten muss bekannt sein.</p></li>
</ul>
<p>Generell ist davon abzuraten, nicht-selbtsbeschreibende binäre Datenformate zu verwenden, da man diese nicht ohne weiteres weiter geben kann.</p>
<p>Im Folgenden werden wir zwei weit verbreitete Datenformate betrachten:</p>
<ul class="simple">
<li><p>CSV (Comma Separated Values): Textbasiertes Datenformat für tabulare Daten</p></li>
<li><p>NetCDF: selbstbeschreibendes binäres Datenformat für Multidimensionale Tensoren</p></li>
</ul>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="csv">
<h2>CSV<a class="headerlink" href="#csv" title="Permalink to this headline">¶</a></h2>
<p>Als Beispiel verwenden wir den <a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/hurrell-north-atlantic-oscillation-nao-index-station-based">Hurrel North Atlantic Oscillation Index (station based)</a>. Der Inhalt der Textdatei hat folgende Struktur:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!head -n 5 data/nao_station_monthly.txt
!echo ...
!tail -n 5 data/nao_station_monthly.txt
</pre></div>
</div>
</div>
</div>
<p>Die Struktur kann beschrieben werden durch:</p>
<ul class="simple">
<li><p>2 Kopfzeilen</p></li>
<li><p>13 Spalten (Jahr, Jan., Feb., …)</p></li>
<li><p>fehlende Werte sind durch ‘-999.’ markiert</p></li>
</ul>
<p>Um die Daten in den Speicher zu laden verwenden wir die Funktion <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.genfromtxt.html#numpy.genfromtxt">numpy.genfromtxt</a>. Falls wir keine fehlenden Werte haben, können wir auch alternativ <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html#numpy.loadtxt">numpy.loadtxt</a> verwenden.</p>
<p><strong>Aufgabe</strong>: Laden die Daten der Datei ‘data/nao_station_monthly.txt’. Maskiere dabei die fehlenden Werte. Dafür brauchst du folgende Parameter der Funktion np.genfromtxt:</p>
<ul class="simple">
<li><p>skipt_header</p></li>
<li><p>missing_values</p></li>
<li><p>usemask</p></li>
</ul>
<p>Speichere die Daten in einen Array. Versuche danach, die Daten so umzustrukturieren, dass du einen Zeitvektor (1D-array) und einen Datenvektor erhälst, der zeitlich fortlaufend ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">nao</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;nao&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;station based monthly NAO index&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="netcdf">
<h2>NETCDF<a class="headerlink" href="#netcdf" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/user_guide.html">NetCDF</a> ist ein Datenformat für arraybasierte multidimensionale binäre Daten, welches selbstbeschreibend ist. NetCDF ist auch eine Sammelung von Bibliotheken und Werkzeugen, um NetCDF Dateien zu öffnen oder mit Ihnen zu Arbeiten.</p>
<div class="section" id="struktur-eine-netcdf-datensatzes">
<h3>Struktur eine NetCDF Datensatzes<a class="headerlink" href="#struktur-eine-netcdf-datensatzes" title="Permalink to this headline">¶</a></h3>
<p>Um sich den Inhalt oder die Struktur eine Datensatzes anzuschauen, verwendet man den Befehl <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/netcdf_utilities_guide.html#ncdump_guide">ncdump</a> in der Linux Kommandozeile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!ncdump -h data/CRUTEM.4.6.0.0.anomalies.nc
</pre></div>
</div>
</div>
</div>
<p>Von diesem Output kann man folgende Datenstruktur erkennen:</p>
<p>Ein Datensatz besteht aus:</p>
<ul class="simple">
<li><p>Dimensionen</p></li>
<li><p>Variablen</p></li>
<li><p>globalen Attributen</p></li>
<li><p>Dimensionen haben einen Namen und eine Länge. Um Dimensionen mit Koordinaten zu versehen, existieren Variablen mit dem gleichen Namen.</p></li>
<li><p>Variablen haben</p>
<ul>
<li><p>einen Datentyp</p></li>
<li><p>einen Namen</p></li>
<li><p>einen shape, definiert durch ein Tuple von Dimensionen</p></li>
<li><p>Attribute</p></li>
</ul>
</li>
<li><p>Attribute haben</p>
<ul>
<li><p>einen Namen</p></li>
<li><p>einen Datentyp</p></li>
<li><p>einen Wert</p></li>
</ul>
</li>
</ul>
<p>Beachte die Länge der Dimension <code class="docutils literal notranslate"><span class="pre">time</span></code>. Diese ist <code class="docutils literal notranslate"><span class="pre">UNLIMITED</span></code>. Das bedeuted, dass die Länge der variabel ist und man jederzeit zusätzliche Zeitscheiben anhängen kann. Dies ist praktisch beim Schreiben von Datensätzen. Beim lesen, insbesondere von großen Datensätzen, ist dies mit Geschwindigkeitseinbußen verbunden.</p>
<p>Standardnamen und -werte für Attribute und Variablen sind für klimabezogene Datensätze in den <a class="reference external" href="http://cfconventions.org/">Climate and Forecast Metadata Conventions (CF conventions)</a> festegelegt.</p>
<p>Nun öffnen wir diesen Datensatz mit Hilfe des <a class="reference external" href="https://unidata.github.io/netcdf4-python/netCDF4/index.html">netCDF4</a> Pakets. Dies tun wir, indem wir ein Objekt der Klasse <a class="reference external" href="https://unidata.github.io/netcdf4-python/netCDF4/index.html#netCDF4.Dataset">netCDF4.Dataset</a> erstellen. Wir können uns die Struktur des Datensatzes anschauen, indem wir das Datensatz Objekt printen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;data/CRUTEM.4.6.0.0.anomalies.nc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Alle Daten und Metadaten des Datensatzes sind als Attribute des Datensatzobjektes verfügbar. Die wichtigsten Attribute sind</p>
<ul>
<li><p>dimensions:</p>
<p>Dictionary, welches die Dimensionsnamen auf Ojekte der Klasse <a class="reference external" href="https://unidata.github.io/netcdf4-python/netCDF4/index.html#netCDF4.Dimension">Dimension</a> abbildet.</p>
</li>
<li><p>variables:</p>
<p>Dictionary, welches die Variablenname auf Objekte der Klasse <a class="reference external" href="https://unidata.github.io/netcdf4-python/netCDF4/index.html#netCDF4.Variable">Variable</a> abbildet. Diese werden verwendet, um Daten zu lesen oder zu schreiben und um
auf die Attribute der Variable zuzugreifen.</p>
</li>
</ul>
<p>Die globalen Attribute sind als Attribute des Datensatzobjekts verfügbar (z.B. <code class="docutils literal notranslate"><span class="pre">ds.reference</span></code>)</p>
<p><strong>Aufgabe:</strong></p>
<ul class="simple">
<li><p>Untersuche den Inhalt der Attribute <code class="docutils literal notranslate"><span class="pre">dimensions</span></code> und <code class="docutils literal notranslate"><span class="pre">variables</span></code>. Wie Lang sind die Dimensionen <code class="docutils literal notranslate"><span class="pre">longitude</span></code> und <code class="docutils literal notranslate"><span class="pre">time</span></code>? Welche Einheit und Datentyp hat die Variable <code class="docutils literal notranslate"><span class="pre">temperature_anomaly</span></code> und auf welchen Dimensionen ist sie definiert?</p></li>
</ul>
</div>
<div class="section" id="lesen-von-daten">
<h3>Lesen von Daten<a class="headerlink" href="#lesen-von-daten" title="Permalink to this headline">¶</a></h3>
<p>Um Daten aus einer Variable in einem netCDF Datensatz in den Speicher zu lesen, wird lediglich das Variablenobjekt indiziert.</p>
<p><strong>Aufgabe:</strong></p>
<ul class="simple">
<li><p>Lese den letzten Zeitschritt der Variable <code class="docutils literal notranslate"><span class="pre">temperature_anomaly</span></code> in den Speicher</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t_anom</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][:],</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:],</span>
    <span class="n">t_anom</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Aufgabe</strong>: Berechne die global gemittelte Temperatur Anomalie. Da die Daten in spärischen Koordinate vorliegen, müssen die einzelnen Datenpunkte mit dem Cosinus der Breite im Bogenmaß gewichtet werden:</p>
<div class="math notranslate nohighlight">
\[ t_{global} = \frac{1}{N M}\sum_{j=1}^M\sum_{i=1}^{N} t_{anom}(j, i) \cos(\theta(j))\]</div>
<p>Versuche dabei, die Broadcasting Funktionalität und die Mittelwertfunktion von Numpy zu verwenden!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lat</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:]</span>
<span class="n">t_anom</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;temperature_anomaly&#39;</span><span class="p">][:]</span>

<span class="n">t_global</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][:],</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">),</span> <span class="n">t_G</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="schreiben-von-netcdf-datensatzen">
<h3>Schreiben von netCDF Datensätzen<a class="headerlink" href="#schreiben-von-netcdf-datensatzen" title="Permalink to this headline">¶</a></h3>
<p>So leicht NetCDF Datensätze gelesen werden können, so umständlich sind sie zu schreiben. Folgende Schritte sind notwendig, um einen Datensatz zu schreiben:</p>
<ol class="simple">
<li><p>Datensatzobjekt erstellen und globale Attribute setzen:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;test.nc&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">contact</span> <span class="o">=</span> <span class="s1">&#39;Martin Claus &lt;mclaus@geomar.de&gt;&#39;</span>
<span class="n">ds</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Zonally averaged surface temperature from NCEP Reanalysis&#39;</span>
<span class="n">ds</span><span class="o">.</span><span class="n">data_source</span> <span class="o">=</span> <span class="s1">&#39;https://www.esrl.noaa.gov/psd/data/gridded/data.ncep.reanalysis.html&#39;</span>
<span class="n">ds</span><span class="o">.</span><span class="n">creation_date</span> <span class="o">=</span> <span class="s1">&#39;16-06-2019&#39;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Dimensionen erstellen:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>   <span class="c1"># unlimited dimension</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Variablen erstellen:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lon</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,))</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Variablendaten schreiben und Attribute anlegen</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lon</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)</span>
<span class="n">lon</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span>
<span class="n">lon</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Latitude&quot;</span>

<span class="n">time</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 2012-01-01 00:00&#39;</span>
<span class="n">time</span><span class="o">.</span><span class="n">calendar</span> <span class="o">=</span> <span class="s1">&#39;gregorian&#39;</span>
<span class="n">time</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span>

<span class="n">t</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degC&#39;</span>
<span class="n">t</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;zonally averaged temperature&#39;</span>

<span class="c1"># write timestamp and data</span>
<span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Datensatz schließen (erst jetzt wird auf die Festplatte geschrieben)</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Aufgabe:</strong> Schreibe die oben ausgerechnete Temperaturzeitreihe inkl. aller relevanten Metadaten in einen NetCDF Datensatz. Verwende dabei möglichst viele Informationen aus dem Quelldatensatz.</p>
<p>Hinweis: Um einen existierenden Datensatz zu überschreiben, muss man das Argument <code class="docutils literal notranslate"><span class="pre">clobber=True</span></code> beim erstellen des Datensatzes verwenden.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="andere-datenformate">
<h2>Andere Datenformate<a class="headerlink" href="#andere-datenformate" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Bibliothek</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>JSON</p></td>
<td><p><a class="reference external" href="https://docs.python.org/3/library/json.html">json</a></p></td>
</tr>
<tr class="row-odd"><td><p>XML</p></td>
<td><p><a class="reference external" href="https://docs.python.org/3/library/xml.etree.elementtree.html">xml.etree.ElementTree</a></p></td>
</tr>
<tr class="row-even"><td><p>xls</p></td>
<td><p>in csv umwandeln oder <a class="reference external" href="https://pandas.pydata.org/">pandas</a></p></td>
</tr>
<tr class="row-odd"><td><p>mat</p></td>
<td><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.loadmat.html#scipy.io.loadmat">scipy.io.loadmat</a></p></td>
</tr>
<tr class="row-even"><td><p>shp</p></td>
<td><p><a class="reference external" href="https://pypi.org/project/pyshp/">pyshp</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020,.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.<br/>
    </p>
  </div>
</footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>